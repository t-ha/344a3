<!DOCTYPE html>
<html>
<head>
    <title>PA3 Tim Ha</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>
    $(document).ready(function () {
        $("#loadCrawl").click(function () {
            $.ajax({
                type: 'POST',
                url: "admin.asmx/LoadCrawler",
                data: '{}',
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    var p = "<p>" + data.d + "</p>";
                    $("#dashMsg").html(p);
                }
            });
        });

        $("#startCrawl").click(function () {
            $.ajax({
                type: 'POST',
                url: "admin.asmx/StartCrawling",
                data: '{}',
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                }
            });
            GetStatsData();
        });

        $("#stopCrawl").click(function () {
            $.ajax({
                type: 'POST',
                url: "admin.asmx/StopCrawling",
                data: '{}',
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                }
            });
        });

    });

    function GetStatsData() {
        setInterval(function () {
            $.ajax({
                type: 'POST',
                url: "admin.asmx/GetStats",
                data: '{}',
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    var obj = $.parseJSON(data.d);
                    var table = "<table>";
                    table = table + "<tr><th>CPU Usage (%)</th><td>" + obj[0] + "</td></tr>";
                    table = table + "<tr><th>Memory Usage (MB Free)</th><td>" + obj[1] + "</td></tr>";
                    table = table + "<tr><th># URLS crawled</th><td>" + obj[2] + "</td></tr>";
                    table = table + "<tr><th># URLS left</th><td>" + obj[3] + "</td></tr>";
                    table = table + "<tr><th>Size of index</th><td>" + obj[4] + "</td></tr>";
                    table = table + "</table>";
                    $("#statsBoard").html(table);
                }
            });
        }, 1000);
    }
    </script>
</head>
<body>
    <div>
        <button id="loadCrawl">Load</button>
        <button id="startCrawl">Start Crawling</button>
        <button id="stopCrawl">Stop Crawling</button>
    </div>
    <div id="dashMsg">

    </div>
    <div id="dashboard">
        <br />
        <div id="statsBoard">

        </div>
    </div>
    <div id="dashboard2">
    </div>
</body>
</html>
